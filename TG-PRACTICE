SELECT m.movie_id,m.title,s.show_datetime from movie m inner join show s on m.movie_id=s.movie_id

SELECT u.name,b.booking_datetime from user u inner join Booking b on u.user_id=b.user_id
--Find all users who have made at least one booking, along with booking date.
SELECT u.name,u.user_id,b.booking_datetime from User u inner join Booking b on u.user_id=b.user_id  

--Identify movies that have multiple shows scheduled.
SELECT m.movie_id,count(s.show_id) as total_shows from Movie m inner join show s on m.movie_id=s.screen_id
group by m.title,m.genre
having count(s.show_id)>1

SELECT m.title,r.review_id,r.content from Movie m left join review r on m.movie_id=r.movie_id

SELECT u.name,m.current_points,m.membership_id from user u left join Membership m on u.user_id=m.user_id

SELECT sc.screen_id,sc.name,s.show_id ,s.show_datetime from screen sc left join show s on sc.screen_id=s.screen_id
SELECT s.show_id,s.show_datetime,sc.name,sc.capacity from show s right join Screen sc on s.screen_id=sc.screen_id

--full outer joIN
SELECT m.title,m.genre,r.content,r.rating from movie m left join Review r on m.movie_id=r.movie_id
UNION
SELECT m.title,m.genre,r.content,r.rating from movie m RIGHT join Review r on m.movie_id=r.movie_id



SELECT u.user_id,u.name,b.booking_id,b.booking_datetime from user u left join booking b on u.user_id=b.user_id
UNION
SELECT u.user_id,u.name,b.booking_id,b.booking_datetime from user u RIGHT join booking b on u.user_id=b.user_id


SELECT m.title as movie_title,s.show_id,s.show_datetime,sc.name from Show s 
inner join Movie m on s.movie_id=m.movie_id
inner join  Screen sc on s.screen_id=sc.screen_id
-- ```using clause```

SELECT u.user_id,u.name,u.email,b.booking_id,b.booking_datetime,b.total_cost from User u 
inner join Booking b using(user_id)
--same output for above one  
``
SELECT user_id,name,email,booking_id,booking_datetime,total_cost from User u 
inner join Booking  using(user_id)
`````
--Management wants to know how many bookings each movie has received.
SELECT count(b.booking_id)as total_booking,m.title,m.genre,b.booking_datetime from show s
left join Booking b on b.show_id=s.show_id
left join Movie m on s.movie_id=m.movie_id
GROUP by m.title
order by total_booking desc
